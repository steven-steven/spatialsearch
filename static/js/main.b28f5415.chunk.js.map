{"version":3,"sources":["Canvas.js","App.js","index.js"],"names":["StyledCanvas","styled","canvas","Canvas","handleClick","canvasRef","position","handleSearch","React","useEffect","ref","width","height","onClick","e","clientX","clientY","Button","button","Controls","div","Step","Container","draw","ctx","location","fillStyle","save","translate","x","y","beginPath","arc","Math","PI","fill","restore","usePersistentCanvas","init","useState","JSON","parse","localStorage","getItem","value","setValue","setItem","stringify","usePersistentState","locations","setLocations","useRef","current","getContext","clearRect","forEach","App","KDBush","index","setIndex","range","setRange","ReactCursorPosition","newLocation","results","within","map","id","slice","type","min","max","onChange","target","step","p","Int32Array","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.b28f5415.chunk.js","sourcesContent":["import React from 'react';\r\nimport styled from 'styled-components';\r\n\r\nconst WIDTH = 500;\r\nconst HEIGHT = 500;\r\n\r\nconst StyledCanvas = styled.canvas`\r\n  border: 1px solid black;\r\n  height: ${HEIGHT}px;\r\n  width: ${WIDTH}px;\r\n`\r\n\r\nfunction Canvas({handleClick, canvasRef, position, handleSearch}) {\r\n\r\n  React.useEffect(() => {\r\n    handleSearch(position);\r\n  }, [handleSearch, position]);\r\n\r\n  return (\r\n      <StyledCanvas\r\n        ref={canvasRef}\r\n        width={WIDTH}\r\n        height={HEIGHT}\r\n        onClick={e => {\r\n          handleClick(e.clientX, e.clientY);\r\n        }}\r\n      />\r\n  ) \r\n}\r\n\r\n\r\nexport default Canvas","import React from 'react';\r\nimport styled from 'styled-components';\r\nimport KDBush from 'kdbush';\r\nimport Canvas from './Canvas';\r\nimport ReactCursorPosition from 'react-cursor-position';\r\n\r\nconst SCALE = 1;\r\nconst OFFSET = 10;\r\nconst WIDTH = 500;\r\nconst HEIGHT = 500;\r\n\r\nconst Button = styled.button`\r\n  height: 4em;\r\n  width: 6em;\r\n  margin: 1em;\r\n  font-weight: bold;\r\n  font-size: 0.5em;\r\n  text-transform: uppercase;\r\n  cursor: pointer;\r\n  color: white;\r\n  border: 1px solid white;\r\n  background-color: black;\r\n\r\n  &:hover {\r\n    color: black;\r\n    background-color: #00baff;\r\n  }\r\n  &:focus {\r\n    border: 1px solid #00baff;\r\n  }\r\n  &:active{\r\n    background-color: #1f1f1f;\r\n    color: white;\r\n  }\r\n`;\r\n\r\nconst Controls = styled.div`\r\n  margin: 20px;\r\n`;\r\n\r\nconst Step = styled.div`\r\n  display: block;\r\n  \r\n  > p{\r\n    font-size: 13px;\r\n  }\r\n`;\r\n\r\nconst Container = styled.div`\r\n  display: flex;\r\n`;\r\n\r\nfunction draw(ctx, location, fillStyle) {\r\n  ctx.fillStyle = fillStyle;\r\n  ctx.save();\r\n  //ctx.scale(SCALE, SCALE);  \r\n  ctx.translate(location.x / SCALE - OFFSET, location.y / SCALE - OFFSET);\r\n  ctx.beginPath();\r\n  ctx.arc(0, 0, 10, 0, 2 * Math.PI);\r\n  ctx.fill();\r\n  ctx.restore();\r\n}\r\n\r\n// Custom hook with local storage\r\nfunction usePersistentState(init) {\r\n  const [value, setValue] = React.useState(JSON.parse(localStorage.getItem('draw-app')) || init); \r\n  // a side effect (store local)\r\n  React.useEffect(() => {\r\n    localStorage.setItem('draw-app', JSON.stringify(value));\r\n  })\r\n  return [value, setValue];\r\n}\r\n\r\n// custom hook to provide location state and side-effect functionality of canvas.\r\nfunction usePersistentCanvas() {\r\n  const [locations, setLocations] = usePersistentState([]);\r\n  \r\n  const canvasRef = React.useRef(null);\r\n  //side effect of changes in state, clear and draw canvas (given the ref)\r\n  React.useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, WIDTH, HEIGHT);\r\n    locations.forEach(location => draw(ctx, location, '#000000'));\r\n  });\r\n  return [locations, setLocations, canvasRef];\r\n}\r\n\r\nfunction App() {\r\n  const [locations, setLocations, canvasRef] = usePersistentCanvas();\r\n  const [index, setIndex] = React.useState(new KDBush([]));\r\n  const [range, setRange] = React.useState(50);\r\n\r\n  function handleClear() {\r\n    setLocations([]);\r\n    setIndex(new KDBush([]));\r\n  }\r\n  function handleUndo() {\r\n    setLocations(locations.slice(0, -1));\r\n  }\r\n  function handleIndex() {\r\n    setIndex(new KDBush(locations, p=>p.x, p=>p.y, 32, Int32Array));\r\n  }\r\n\r\n  function handleSearch(position){\r\n    const results = index.within(position.x, position.y, range).map(id => locations[id]);\r\n    const canvas = canvasRef.current;\r\n    const ctx = canvas.getContext('2d');\r\n    ctx.clearRect(0, 0, WIDTH, HEIGHT);\r\n    locations.forEach(location => draw(ctx, location, '#000000'));\r\n    results.forEach(location => draw(ctx, location, \"#ffa500\"));\r\n  }\r\n  \r\n  function handleClick(x,y){\r\n    const newLocation = { x, y };\r\n    setLocations([...locations, newLocation]);\r\n  }\r\n\r\n  return (\r\n    <Container>\r\n      <ReactCursorPosition>\r\n        <Canvas\r\n          canvasRef={canvasRef}\r\n          handleClick={handleClick} \r\n          handleSearch={handleSearch}\r\n        />\r\n      </ReactCursorPosition>\r\n\r\n      <Controls>\r\n        <Step>\r\n          <p>Step 1: Plot Coordinates</p>\r\n          <Button onClick={handleClear}>Clear</Button>\r\n          <Button onClick={handleUndo}>Undo</Button>\r\n        </Step>\r\n        <Step>\r\n          <p>Step 2: Specify Range of Search ({range}px)</p>\r\n          <input \r\n            type=\"range\" \r\n            min=\"10\"\r\n            max=\"250\" \r\n            value={range} \r\n            onChange={(e)=>{setRange(e.target.value)}}\r\n            step=\"10\"/>\r\n        </Step>\r\n        <Step>\r\n          <p>Step 3: Index and Hover over</p>\r\n          <Button onClick={handleIndex}>Index</Button>\r\n        </Step>\r\n      </Controls>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default App","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n"],"sourceRoot":""}